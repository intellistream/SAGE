### 3.1 äº¤äº’å¼è°ƒè¯•é¢æ¿ (Playground) â­â­â­

**åŠŸèƒ½æè¿°**:
- ç”»å¸ƒå³ä¾§/ä¸‹æ–¹å¯æŠ˜å é¢æ¿
- å®æ—¶ä¸æµç¨‹äº¤äº’ï¼Œè¾“å…¥é—®é¢˜æŸ¥çœ‹è¾“å‡º
- æ˜¾ç¤ºä¸­é—´æ­¥éª¤å’Œæ‰§è¡Œæ—¶é—´
- æ”¯æŒæµå¼è¾“å‡º

**æŠ€æœ¯å®ç°**:
```typescript
// frontend-v2/src/components/PlaygroundPanel.tsx
interface PlaygroundPanelProps {
  flowId: string;
  isRunning: boolean;
}

// åŠŸèƒ½ï¼š
// 1. WebSocket è¿æ¥åˆ°åç«¯
// 2. å‘é€ç”¨æˆ·è¾“å…¥
// 3. å®æ—¶æ¥æ”¶æµå¼è¾“å‡º
// 4. æ˜¾ç¤ºä¸­é—´èŠ‚ç‚¹çŠ¶æ€
```

```python
# backend: api.py
@router.post("/flows/{flow_id}/chat")
async def chat_with_flow(
    flow_id: str,
    message: str,
    tweaks: Optional[Dict] = None,
    stream: bool = True
):
    """å®æ—¶æ‰§è¡Œæµç¨‹å¹¶è¿”å›ç»“æœ"""
    # 1. åŠ è½½æµç¨‹
    # 2. åº”ç”¨ tweaks
    # 3. æ‰§è¡Œæµç¨‹
    # 4. æµå¼è¿”å›ä¸­é—´ç»“æœå’Œæœ€ç»ˆè¾“å‡º
```


#### 3.2 è¿è¡Œæ—¶å‚æ•°è¦†ç›– (Tweaks) â­â­

**åŠŸèƒ½æè¿°**:
- åœ¨ Playground ä¸­ä¸´æ—¶è¦†ç›–èŠ‚ç‚¹å‚æ•°
- ä¸ä¿®æ”¹æµç¨‹æœ¬èº«
- æ”¯æŒ JSON æˆ–è¡¨å•è¾“å…¥
- è®°å½•æœ€ä½³å‚æ•°ç»„åˆ

**æŠ€æœ¯å®ç°**:
```typescript
// PlaygroundPanel.tsx
interface Tweak {
  nodeId: string;
  parameter: string;
  value: any;
}

// UI: æ˜¾ç¤ºå¯è°ƒæ•´çš„å‚æ•°åˆ—è¡¨
// ç”¨æˆ·ä¿®æ”¹åï¼Œå‘é€åˆ°åç«¯æ‰§è¡Œ
```

**ä¼˜åŠ¿**:
- âœ… å¿«é€Ÿå®éªŒä¸åŒå‚æ•°ç»„åˆ
- âœ… A/B æµ‹è¯•æ›´ä¾¿æ·
- âœ… æ‰¾åˆ°æœ€ä½³é…ç½®æ›´å®¹æ˜“

#### 3.3 çŠ¶æ€è½®è¯¢ä¸å®æ—¶æ›´æ–° â­

**åŠŸèƒ½æè¿°**:
- æµç¨‹è¿è¡Œæ—¶ï¼Œç”»å¸ƒè‡ªåŠ¨åˆ·æ–°èŠ‚ç‚¹çŠ¶æ€
- æ˜¾ç¤ºæ¯ä¸ªèŠ‚ç‚¹çš„æ‰§è¡Œè¿›åº¦
- é«˜äº®å½“å‰æ‰§è¡Œçš„èŠ‚ç‚¹
- æ˜¾ç¤ºé”™è¯¯å’Œè­¦å‘Š

**æŠ€æœ¯å®ç°**:
```typescript
// å‰ç«¯ï¼šæ¯ç§’è½®è¯¢æˆ– WebSocket è®¢é˜…
useEffect(() => {
  const interval = setInterval(() => {
    fetchJobStatus(jobId).then(status => {
      updateNodeStates(status.nodeStates);
    });
  }, 1000);
}, [jobId]);
```

**ä¼˜åŠ¿**:
- âœ… è¿½å¹³ Phase 2 æœ€å 15% çš„æ ¸å¿ƒåŠŸèƒ½
- âœ… ç”¨æˆ·ä½“éªŒå¤§å¹…æå‡

#### 3.4 æµç¨‹æ¨¡æ¿åº“ â­

**åŠŸèƒ½æè¿°**:
- å†…ç½® 10-15 ä¸ªå¸¸è§ RAG æ¨¡æ¿
- ä¸€é”®åŠ è½½å’Œä¿®æ”¹
- åŒ…å«è¯¦ç»†è¯´æ˜å’Œæœ€ä½³å®è·µ

**æ¨¡æ¿ç¤ºä¾‹**:
1. åŸºç¡€é—®ç­” RAG
2. å¤šæ–‡æ¡£å¯¹æ¯” RAG
3. æ··åˆæ£€ç´¢ (Dense + Sparse)
4. é‡æ’åº RAG
5. Agent + RAG
6. å¤šæ¨¡æ€ RAG
7. é•¿æ–‡æ¡£æ‘˜è¦
8. çŸ¥è¯†å›¾è°± RAG

**ä¼˜åŠ¿**:
- âœ… é™ä½å…¥é—¨é—¨æ§›
- âœ… å±•ç¤ºæœ€ä½³å®è·µ
- âœ… è¿½å¹³ Coze çš„æ˜“ç”¨æ€§

---


##### 4.1.1 è‡ªåŠ¨åŒ–è¯„ä¼°æ¡†æ¶

**åŠŸèƒ½æè¿°**:
- æ”¯æŒå¤šç§è¯„ä¼°æŒ‡æ ‡ï¼ˆContext Precision, Recall, Faithfulness, Answer Relevancyï¼‰
- è‡ªåŠ¨è¿è¡Œè¯„ä¼°æ•°æ®é›†
- ç”Ÿæˆè¯¦ç»†æŠ¥å‘Šå’Œå¯è§†åŒ–
- å¯¹æ¯”å¤šä¸ªæµç¨‹ç‰ˆæœ¬

**æŠ€æœ¯å®ç°**:
```python
# æ–°å¢è¯„ä¼°ç®—å­
class RAGEvaluator(BaseOperator):
    """RAG è¯„ä¼°ç®—å­"""
    
    def evaluate(self, 
                 questions: List[str],
                 contexts: List[List[str]],
                 answers: List[str],
                 ground_truths: List[str]) -> Dict:
        """
        è®¡ç®—å¤šç§è¯„ä¼°æŒ‡æ ‡
        è¿”å›è¯¦ç»†çš„è¯„ä¼°æŠ¥å‘Š
        """
        return {
            "context_precision": self._calc_precision(contexts, ground_truths),
            "context_recall": self._calc_recall(contexts, ground_truths),
            "faithfulness": self._calc_faithfulness(answers, contexts),
            "answer_relevancy": self._calc_relevancy(answers, questions),
            "latency": self._calc_latency(),
        }
```

**å‰ç«¯å¯è§†åŒ–**:
```typescript
// EvaluationDashboard.tsx
// åŠŸèƒ½ï¼š
// 1. é›·è¾¾å›¾ï¼šæ˜¾ç¤ºå„é¡¹æŒ‡æ ‡å¾—åˆ†
// 2. å¯¹æ¯”å›¾ï¼šå¤šä¸ªç‰ˆæœ¬çš„å¯¹æ¯”
// 3. è¯¦ç»†åˆ—è¡¨ï¼šæ¯ä¸ªé—®é¢˜çš„è¯¦ç»†å¾—åˆ†
// 4. å»ºè®®é¢æ¿ï¼šAI ç”Ÿæˆçš„ä¼˜åŒ–å»ºè®®
```

**ä¼˜åŠ¿**:
- âœ…âœ…âœ… **æ ¸å¿ƒå·®å¼‚åŒ–ç«äº‰åŠ›**
- âœ… LangFlow/Coze éƒ½æ²¡æœ‰çš„ä¸“ä¸šåŠŸèƒ½
- âœ… ä»"èƒ½ç”¨"åˆ°"ä¸“ä¸š"çš„å…³é”®

##### 4.1.2 A/B æµ‹è¯•ä¸å®éªŒç®¡ç†

**åŠŸèƒ½æè¿°**:
- åŒæ—¶è¿è¡Œå¤šä¸ªæµç¨‹ç‰ˆæœ¬
- è‡ªåŠ¨å¯¹æ¯”è¯„ä¼°ç»“æœ
- ç»Ÿè®¡æ˜¾è‘—æ€§æ£€éªŒ
- å®éªŒå†å²è®°å½•

**ä¼˜åŠ¿**:
- âœ… ç§‘å­¦çš„æ€§èƒ½ä¼˜åŒ–æµç¨‹
- âœ… é€‚åˆç ”ç©¶å’Œç”Ÿäº§ç¯å¢ƒ

#### 4.2 æ·±åº¦å¯è§£é‡Šæ€§ä¸è°ƒè¯• â­â­â­â­

**æ ¸å¿ƒä»·å€¼**: è®© RAG æµç¨‹é€æ˜å¯æ§

##### 4.2.1 æ•°æ®æµå¯è§†åŒ–

**åŠŸèƒ½æè¿°**:
- æ‰§è¡Œåï¼Œç‚¹å‡»èŠ‚ç‚¹æŸ¥çœ‹è¯¦ç»†è¾“å…¥è¾“å‡º
- é«˜äº®æ•°æ®æµåŠ¨è·¯å¾„
- æ˜¾ç¤ºæ¯ä¸ª chunk çš„æ¥æºã€åˆ†æ•°ã€æ’åºå˜åŒ–
- å¯è§†åŒ– rerank å‰åçš„å˜åŒ–

**æŠ€æœ¯å®ç°**:
```typescript
// DataFlowVisualization.tsx
// åŠŸèƒ½ï¼š
// 1. ç‚¹å‡»èŠ‚ç‚¹åï¼Œåœ¨ä¾§è¾¹æ æ˜¾ç¤ºè¯¦ç»†æ•°æ®
// 2. å¯¹äº retrieverï¼šæ˜¾ç¤ºæ‰€æœ‰æ£€ç´¢åˆ°çš„ chunks
// 3. å¯¹äº rerankerï¼šæ˜¾ç¤ºåˆ†æ•°å˜åŒ–
// 4. å¯¹äº LLMï¼šæ˜¾ç¤º prompt å’Œ response
```

**ä¼˜åŠ¿**:
- âœ… æ·±åº¦ç†è§£ RAG ä¸ºä½•è¿”å›æŸä¸ªç»“æœ
- âœ… è°ƒè¯•å¤æ‚æµç¨‹çš„åˆ©å™¨
- âœ… LangFlow/Coze æ— æ³•è¾¾åˆ°çš„æ·±åº¦

##### 4.2.2 æ‰§è¡Œ Trace ä¸æ€§èƒ½åˆ†æ

**åŠŸèƒ½æè¿°**:
- ç±»ä¼¼ LangSmith çš„ trace åŠŸèƒ½
- æ˜¾ç¤ºæ¯ä¸ªèŠ‚ç‚¹çš„æ‰§è¡Œæ—¶é—´
- è¯†åˆ«æ€§èƒ½ç“¶é¢ˆ
- æä¾›ä¼˜åŒ–å»ºè®®

**å¯è§†åŒ–**:
```
Timeline View:
[Source] ----2ms-----> [Chunking] ----150ms-----> 
[Embedding] ----500ms-----> [Retrieval] ----50ms-----> 
[Rerank] ----300ms-----> [LLM] ----2000ms-----> [Output]

Bottleneck: LLM (2000ms, 66% of total)
Suggestion: è€ƒè™‘ä½¿ç”¨æ›´å°çš„æ¨¡å‹æˆ–å¯ç”¨ç¼“å­˜
```

**ä¼˜åŠ¿**:
- âœ… æ€§èƒ½ä¼˜åŒ–æœ‰æ®å¯ä¾
- âœ… ç”Ÿäº§ç¯å¢ƒç›‘æ§åŸºç¡€

#### 4.3 AI è¾…åŠ©ä¼˜åŒ– â­â­â­â­â­

**æ ¸å¿ƒä»·å€¼**: **å¼•å…¥ AI å¸® AI è°ƒä¼˜ï¼Œå½¢æˆæ™ºèƒ½é—­ç¯**

**åŠŸèƒ½æè¿°**:
- åŸºäºè¯„ä¼°ç»“æœï¼ŒAI Agent åˆ†ææµç¨‹ç“¶é¢ˆ
- è‡ªåŠ¨ç”Ÿæˆä¼˜åŒ–å»ºè®®ï¼ˆæ–‡å­— + ä»£ç ï¼‰
- æ”¯æŒä¸€é”®åº”ç”¨å»ºè®®
- å­¦ä¹ å†å²ä¼˜åŒ–ç»éªŒ

**ç¤ºä¾‹åœºæ™¯**:
```
è¾“å…¥ï¼šä¸€ä¸ªå¬å›ç‡ä½çš„ RAG æµç¨‹

AI åˆ†æï¼š
1. æ£€æµ‹åˆ°å¬å›ç‡ä»… 45%ï¼Œä½äºæ¨èçš„ 70%
2. å½“å‰ä½¿ç”¨å•ä¸€æ£€ç´¢å™¨ï¼ˆDenseï¼‰
3. Query è¾ƒçŸ­ï¼Œå¹³å‡ 8 ä¸ª token

å»ºè®®ï¼š
âœ… æ·»åŠ  BM25 æ£€ç´¢å™¨ï¼Œæ„å»ºæ··åˆæ£€ç´¢
âœ… æ·»åŠ  Query Expansion èŠ‚ç‚¹ï¼ˆHyDE æˆ– Multi-Queryï¼‰
âœ… è°ƒæ•´ top_k ä» 5 å¢åŠ åˆ° 10

ä¸€é”®åº”ç”¨ï¼š[åº”ç”¨å»ºè®®] æŒ‰é’®
```

**æŠ€æœ¯å®ç°**:
```python
# AI Optimizer Agent
class RAGOptimizer:
    def analyze(self, 
                flow: Pipeline, 
                evaluation: Dict) -> List[Suggestion]:
        """
        ä½¿ç”¨ LLM åˆ†ææµç¨‹å’Œè¯„ä¼°ç»“æœ
        ç”Ÿæˆç»“æ„åŒ–çš„ä¼˜åŒ–å»ºè®®
        """
        prompt = f"""
        ä½ æ˜¯ä¸€ä¸ª RAG ä¸“å®¶ã€‚åˆ†æä»¥ä¸‹æµç¨‹å’Œè¯„ä¼°ç»“æœï¼š
        
        æµç¨‹ç»“æ„ï¼š{flow.to_dict()}
        è¯„ä¼°ç»“æœï¼š{evaluation}
        
        è¯·æä¾› 3-5 æ¡å…·ä½“çš„ä¼˜åŒ–å»ºè®®ï¼ŒåŒ…æ‹¬ï¼š
        1. é—®é¢˜è¯Šæ–­
        2. ä¼˜åŒ–æ–¹æ¡ˆ
        3. é¢„æœŸæ•ˆæœ
        """
        
        suggestions = llm.generate(prompt)
        return self._parse_suggestions(suggestions)
```

#### 4.4 çŸ¥è¯†å›¾è°±ä¸ç»“æ„åŒ–æ•°æ®æ”¯æŒ â­â­â­

**åŠŸèƒ½æè¿°**:
- æ”¯æŒä»çŸ¥è¯†å›¾è°±æ£€ç´¢
- å¯è§†åŒ–å®ä½“å’Œå…³ç³»
- ç»“æ„åŒ–æ•°æ®æºï¼ˆSQLã€GraphQLï¼‰
- æ··åˆæ£€ç´¢ï¼ˆå‘é‡ + å›¾è°±ï¼‰

**ä¼˜åŠ¿**:
- âœ… æ”¯æŒæ›´å¤æ‚çš„ RAG åœºæ™¯

---


#### 5.2 Agent åŸç”Ÿæ”¯æŒ â­â­â­â­â­

##### 5.2.1 Agent ç¼–æ’èƒ½åŠ›

**åŠŸèƒ½æè¿°**:
- åœ¨ç”»å¸ƒä¸­å¯è§†åŒ–æ„å»º Agent
- æ”¯æŒ ReAct, Function Calling, Multi-Agent
- Agent å¯ä»¥è°ƒç”¨ SAGE æµç¨‹ä½œä¸º Tool
- å¯è§†åŒ– Agent çš„æ€è€ƒè¿‡ç¨‹

**æŠ€æœ¯å®ç°**:
```python
# æ–°å¢ Agent ç®—å­
class AgentExecutor(BaseOperator):
    """Agent æ‰§è¡Œå™¨"""
    
    def __init__(self, llm, tools, agent_type="react"):
        self.llm = llm
        self.tools = tools  # å¯ä»¥æ˜¯ SAGE æµç¨‹
        self.agent_type = agent_type
    
    def execute(self, query):
        # æ‰§è¡Œ Agent å¾ªç¯
        # è¿”å›æ€è€ƒæ­¥éª¤å’Œæœ€ç»ˆç»“æœ
```

**å¯è§†åŒ–**:
```
Agent æ€è€ƒè¿‡ç¨‹ï¼š
1. [Thought] æˆ‘éœ€è¦æ£€ç´¢ç›¸å…³æ–‡æ¡£
2. [Action] è°ƒç”¨ RAG_Pipeline å·¥å…·
3. [Observation] æ‰¾åˆ° 3 ä¸ªç›¸å…³æ–‡æ¡£
4. [Thought] ä¿¡æ¯è¶³å¤Ÿï¼Œå¯ä»¥å›ç­”
5. [Final Answer] ...
```

**ä¼˜åŠ¿**:
- âœ… è¡¥é½æœ€å¤§çŸ­æ¿
- âœ… RAG + Agent çš„å¼ºå¤§ç»„åˆ

##### 5.2.2 SAGE æµç¨‹ä½œä¸º Tool

**åŠŸèƒ½æè¿°**:
- ä»»ä½• SAGE æµç¨‹éƒ½å¯å°è£…ä¸º Tool
- æä¾›æ ‡å‡†çš„ Tool æ¥å£ï¼ˆLangChain, OpenAI Functionï¼‰
- è‡ªåŠ¨ç”Ÿæˆ Tool æè¿°

**ç¤ºä¾‹**:
```python
# å°† SAGE æµç¨‹å¯¼å‡ºä¸º LangChain Tool
from langchain.tools import Tool

rag_tool = sage_flow.export_as_tool(
    name="document_qa",
    description="å›ç­”å…³äºæŠ€æœ¯æ–‡æ¡£çš„é—®é¢˜"
)

# åœ¨ LangChain Agent ä¸­ä½¿ç”¨
agent = initialize_agent(
    tools=[rag_tool, ...],
    llm=llm,
    agent="zero-shot-react-description"
)
```

---

## ğŸ¯ å®æ–½è·¯çº¿å›¾

### Week 1-2: Phase 3 æ ¸å¿ƒä½“éªŒ

```
Day 1-3:  Playground åŸºç¡€ç‰ˆï¼ˆWebSocket + å®æ—¶è¾“å‡ºï¼‰
Day 4-5:  çŠ¶æ€è½®è¯¢ï¼ˆèŠ‚ç‚¹çŠ¶æ€å®æ—¶æ›´æ–°ï¼‰
Day 6-7:  Tweaks å®ç°ï¼ˆè¿è¡Œæ—¶å‚æ•°è¦†ç›–ï¼‰
Day 8-10: æµç¨‹æ¨¡æ¿åº“ï¼ˆ10ä¸ªæ¨¡æ¿ + æ–‡æ¡£ï¼‰
Day 11-14: æµ‹è¯•å’Œä¼˜åŒ–
```

### Week 3-6: Phase 4 RAG ä¸“ä¸šåŒ–

```
Week 3:   RAG è¯„ä¼°æ¡†æ¶ï¼ˆåŸºç¡€æŒ‡æ ‡ + æ•°æ®é›†æ”¯æŒï¼‰
Week 4:   è¯„ä¼°å¯è§†åŒ–ï¼ˆDashboard + å¯¹æ¯”åŠŸèƒ½ï¼‰
Week 5:   æ·±åº¦è°ƒè¯•ï¼ˆæ•°æ®æµå¯è§†åŒ– + Traceï¼‰
Week 6:   AI ä¼˜åŒ–åŠ©æ‰‹ï¼ˆåŸºç¡€ç‰ˆï¼‰
```