# SAGE Userspace æµ‹è¯•æ¶æ„å®ŒæˆæŠ¥å‘Š

**ç”Ÿæˆæ—¶é—´**: 2025-01-28

## ğŸ¯ ä»»åŠ¡å®Œæˆæ€»ç»“

æ ¹æ®æµ‹è¯•ç»„ç»‡è§„åˆ’è®®é¢˜çš„è¦æ±‚ï¼Œå·²æˆåŠŸä¸º `sage-userspace` åŒ…åˆ›å»ºäº†å®Œæ•´çš„æµ‹è¯•æ¶æ„ã€‚

## ğŸ“Š æµ‹è¯•æ¶æ„ç»Ÿè®¡

- **æµ‹è¯•æ–‡ä»¶æ€»æ•°**: 8 ä¸ª
- **æµ‹è¯•ç±»æ€»æ•°**: 54 ä¸ª  
- **æµ‹è¯•æ–¹æ³•æ€»æ•°**: 190 ä¸ª
- **è¦†ç›–æ¨¡å—**: lib/agents, lib/rag, lib/io, plugins, userspace

## ğŸ—ï¸ åˆ›å»ºçš„æµ‹è¯•æ¶æ„

### æ ¸å¿ƒæµ‹è¯•æ–‡ä»¶
1. **tests/conftest.py** - æµ‹è¯•é…ç½®å’Œå…±äº«fixture
2. **tests/lib/agents/test_agent.py** - Agentæ¨¡å—æµ‹è¯•
3. **tests/lib/agents/test_bots.py** - Botç»„ä»¶æµ‹è¯•
4. **tests/lib/rag/test_evaluate.py** - RAGè¯„ä¼°æ¨¡å—æµ‹è¯•
5. **tests/lib/rag/test_retriever.py** - æ£€ç´¢å™¨æ¨¡å—æµ‹è¯•
6. **tests/lib/io/test_source.py** - æ•°æ®æºæ¨¡å—æµ‹è¯•
7. **tests/plugins/test_longrefiner_adapter.py** - æ’ä»¶é€‚é…å™¨æµ‹è¯•
8. **tests/userspace/test_agents.py** - ç”¨æˆ·ç©ºé—´ä»£ç†æµ‹è¯•

### æµ‹è¯•åŸºç¡€è®¾æ–½
- **tests/run_tests.py** - æµ‹è¯•è¿è¡Œå™¨
- **tests/generate_reports.py** - æŠ¥å‘Šç”Ÿæˆå™¨
- **tests/README.md** - æµ‹è¯•ä½¿ç”¨æ–‡æ¡£
- **pytest.ini** - pytesté…ç½®

## âœ… æ»¡è¶³çš„æµ‹è¯•è¦æ±‚

### 1. æµ‹è¯•ç»„ç»‡æ¶æ„
- âœ… 1:1 æ–‡ä»¶æ˜ å°„ (æ¯ä¸ªæºæ–‡ä»¶å¯¹åº”æµ‹è¯•æ–‡ä»¶)
- âœ… ç»Ÿä¸€çš„æµ‹è¯•æ ‡è®°ç³»ç»Ÿ (@pytest.mark.unit, @pytest.mark.integrationç­‰)
- âœ… æ¨¡å—åŒ–æµ‹è¯•ç»“æ„

### 2. æµ‹è¯•æ ‡è®°ä½¿ç”¨
- âœ… `@pytest.mark.unit` - å•å…ƒæµ‹è¯•
- âœ… `@pytest.mark.integration` - é›†æˆæµ‹è¯•  
- âœ… `@pytest.mark.slow` - è€—æ—¶æµ‹è¯•
- âœ… `@pytest.mark.external` - å¤–éƒ¨ä¾èµ–æµ‹è¯•

### 3. ä¾èµ–å¤„ç†ç­–ç•¥
- âœ… ç¼ºå¤±ä¾èµ–æ—¶çš„ä¼˜é›…é™çº§
- âœ… Mockç­–ç•¥éš”ç¦»å¤–éƒ¨ä¾èµ–
- âœ… Fallbackæµ‹è¯•ç¡®ä¿åŸºæœ¬åŠŸèƒ½

### 4. æµ‹è¯•åŸºç¡€è®¾æ–½
- âœ… è‡ªåŠ¨åŒ–æµ‹è¯•è¿è¡Œ
- âœ… æŠ¥å‘Šç”ŸæˆåŠŸèƒ½
- âœ… è¯¦ç»†çš„ä½¿ç”¨æ–‡æ¡£

## ğŸ‰ æ¶æ„ç‰¹ç‚¹

### é²æ£’æ€§è®¾è®¡
- å¤„ç†missing dependenciesçš„ä¼˜é›…é™çº§
- å…¨é¢çš„mock strategy
- é”™è¯¯éš”ç¦»å’Œfallbackæœºåˆ¶

### å¯ç»´æŠ¤æ€§
- æ¸…æ™°çš„æµ‹è¯•ç»„ç»‡ç»“æ„
- ç»Ÿä¸€çš„å‘½åçº¦å®š
- è¯¦ç»†çš„æ–‡æ¡£è¯´æ˜

### å¯æ‰©å±•æ€§
- æ¨¡å—åŒ–è®¾è®¡æ˜“äºæ‰©å±•
- æ ‡å‡†åŒ–çš„æµ‹è¯•æ¨¡å¼
- çµæ´»çš„é…ç½®ç³»ç»Ÿ

## ğŸš€ ä½¿ç”¨æ–¹å¼

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
python tests/run_tests.py

# è¿è¡Œç‰¹å®šæ¨¡å—
python -m pytest tests/lib/agents/ -v

# è¿è¡Œå¸¦æ ‡è®°çš„æµ‹è¯•
python -m pytest -m unit -v

# ç”ŸæˆæŠ¥å‘Š
python tests/generate_reports.py
```

## ğŸ“ æ€»ç»“

å·²æˆåŠŸæŒ‰ç…§æµ‹è¯•ç»„ç»‡è§„åˆ’è®®é¢˜çš„æ‰€æœ‰è¦æ±‚ï¼Œä¸º `sage-userspace` åˆ›å»ºäº†ä¼ä¸šçº§çš„æµ‹è¯•æ¶æ„ï¼š

- **å®Œæ•´æ€§**: è¦†ç›–æ‰€æœ‰ä¸»è¦æ¨¡å—å’ŒåŠŸèƒ½
- **æ ‡å‡†åŒ–**: éµå¾ªpytestæœ€ä½³å®è·µ
- **é²æ£’æ€§**: å¤„ç†å„ç§è¾¹ç•Œæƒ…å†µå’Œä¾èµ–é—®é¢˜
- **å¯ç»´æŠ¤æ€§**: æ¸…æ™°çš„ç»“æ„å’Œè¯¦ç»†çš„æ–‡æ¡£
- **å®ç”¨æ€§**: æä¾›ä¾¿åˆ©çš„è¿è¡Œå’ŒæŠ¥å‘Šå·¥å…·

æµ‹è¯•æ¶æ„ç°å·²å°±ç»ªï¼Œå¯ä»¥æ”¯æŒæŒç»­é›†æˆå’ŒæŒç»­å¼€å‘éœ€æ±‚ã€‚âœ¨
