# ============================================================
# PreRetrieval 实验: MemoryOS + Baseline (H1)
# 记忆体结构: MemoryOS (三层分层记忆 + 热度迁移)
# PreRetrieval 策略: none (对照基线)
# ============================================================

runtime:
  dataset: "locomo"
  memory_insert_verbose: false
  memory_test_verbose: true
  test_segments: 10

  prompt_template: |
    Based on the above context, answer the following question concisely.

    Question: {question}
    Answer:

  prompt_template_category5: |
    Based on the above context, answer the following question.

    Question: {question}
    Answer:

  # LLM 配置 (统一)
  api_key: "token-abc123"
  base_url: "http://sage2:8000/v1"
  model_name: "/home/cyb/Llama-3.1-8B-Instruct"
  max_tokens: 512
  temperature: 0.3
  seed: 42
  memory_name: "MemoryOS_Baseline"

  # Embedding 配置 (统一)
  embedding_base_url: "http://localhost:8091/v1"
  embedding_model: "BAAI/bge-m3"

# ============================================================
# 服务配置: MemoryOS (hierarchical_memory)
# ============================================================
services:
  register_memory_service: "hierarchical_memory"
  hierarchical_memory:
    tier_mode: "three_tier"
    tier_names: ["stm", "mtm", "lpm"]
    tier_capacities:
      stm: 20
      mtm: 200
      lpm: -1
    migration_policy: "heat"
    heat_threshold: 0.7
    cold_threshold: 0.3
    embedding_dim: 1024

# ============================================================
# Operator 配置: 固定其他阶段为 MemoryOS baseline
# ============================================================
operators:
  # PreInsert: 固定为 MemoryOS 的重要性评分
  pre_insert:
    action: "score"
    score_type: "importance"

  # PostInsert: 固定为 MemoryOS 的热度迁移
  post_insert:
    action: "migrate"
    migrate_policy: "heat"
    heat_threshold: 0.7
    cold_threshold: 0.3

  # PreRetrieval: 实验变量 - Baseline
  pre_retrieval:
    action: "none"  # 直接使用原始问题，不做任何优化

  # PostRetrieval: 固定为 MemoryOS 的增强
  post_retrieval:
    action: "augment"
    augment_type: "persona"
