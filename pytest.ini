# pytest 配置文件 - Monorepo 结构
[tool:pytest]
testpaths = 
    packages/sage-utils/tests
    packages/sage-core/tests
    packages/sage-lib/tests
    packages/sage-extensions/tests
    packages/sage-plugins/tests
    packages/sage-service/tests
    packages/sage-tools/sage-cli/tests
    app/tests
python_files = test_*.py
python_classes = Test*
python_functions = test_*
# 排除第三方依赖的测试目录和构建目录
norecursedirs = 
    .git
    .tox
    dist
    build
    south_migrations
    .eggs
    *.egg-info
    .pytest_cache
    __pycache__
    .coverage*
    **/build/**
    **/_deps/**
    **/third_party/**
    **/external/**
    **/vendor/**
    packages/*/build/**
    packages/**/build/**
    packages/**/_deps/**
# 明确忽略第三方依赖的测试文件收集
collect_ignore_glob = 
    **/build/**
    **/_deps/**
    **/third_party/**
    **/external/**
    **/vendor/**
    **/pybind11*/**
addopts = 
    -v
    --tb=short
    --strict-markers
    --disable-warnings
    --import-mode=importlib
    # Coverage disabled due to data file corruption issues
    # --cov=sage
    # --cov-report=term-missing
markers =
    slow: marks tests as slow (deselect with '-m "not slow"')
    integration: marks tests as integration tests
    unit: marks tests as unit tests
    backward_compatibility: marks backward compatibility tests
    package: marks package-specific tests
