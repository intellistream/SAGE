<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1200" height="800" viewBox="0 0 1200 800">
  <defs>
    <style>
      .title { font: bold 24px sans-serif; fill: #2c3e50; }
      .section-title { font: bold 18px sans-serif; fill: #34495e; }
      .component { font: 14px sans-serif; fill: #2c3e50; }
      .small-text { font: 12px sans-serif; fill: #7f8c8d; }
      .box { fill: #ecf0f1; stroke: #34495e; stroke-width: 2; }
      .box-blue { fill: #3498db; stroke: #2980b9; stroke-width: 2; }
      .box-green { fill: #2ecc71; stroke: #27ae60; stroke-width: 2; }
      .box-orange { fill: #e67e22; stroke: #d35400; stroke-width: 2; }
      .box-purple { fill: #9b59b6; stroke: #8e44ad; stroke-width: 2; }
      .box-red { fill: #e74c3c; stroke: #c0392b; stroke-width: 2; }
      .text-white { fill: #ffffff; }
      .arrow { fill: none; stroke: #34495e; stroke-width: 2; marker-end: url(#arrowhead); }
      .arrow-dashed { fill: none; stroke: #7f8c8d; stroke-width: 2; stroke-dasharray: 5,5; marker-end: url(#arrowhead-gray); }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#34495e" />
    </marker>
    <marker id="arrowhead-gray" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#7f8c8d" />
    </marker>
  </defs>

  <!-- Title -->
  <text x="600" y="40" class="title" text-anchor="middle">SAGE Architecture</text>

  <!-- User Layer -->
  <rect x="50" y="70" width="280" height="100" class="box-blue" rx="5"/>
  <text x="190" y="95" class="section-title text-white" text-anchor="middle">User Layer</text>
  <text x="190" y="120" class="component text-white" text-anchor="middle">Applications</text>
  <text x="190" y="140" class="small-text text-white" text-anchor="middle">RAG, Agent, Memory, QA</text>

  <!-- API Layer -->
  <rect x="50" y="200" width="280" height="120" class="box-green" rx="5"/>
  <text x="190" y="225" class="section-title text-white" text-anchor="middle">API Layer</text>
  <rect x="70" y="240" width="110" height="60" class="box" rx="3"/>
  <text x="125" y="260" class="component" text-anchor="middle">LocalEnvironment</text>
  <text x="125" y="280" class="small-text" text-anchor="middle">Local Execution</text>
  <rect x="200" y="240" width="110" height="60" class="box" rx="3"/>
  <text x="255" y="260" class="component" text-anchor="middle">RemoteEnvironment</text>
  <text x="255" y="280" class="small-text" text-anchor="middle">Distributed Execution</text>

  <!-- Core Layer -->
  <rect x="50" y="350" width="280" height="180" class="box-orange" rx="5"/>
  <text x="190" y="375" class="section-title text-white" text-anchor="middle">Core Layer</text>
  
  <rect x="70" y="390" width="110" height="55" class="box" rx="3"/>
  <text x="125" y="410" class="component" text-anchor="middle">Dispatcher</text>
  <text x="125" y="428" class="small-text" text-anchor="middle">Task Scheduling</text>
  
  <rect x="200" y="390" width="110" height="55" class="box" rx="3"/>
  <text x="255" y="410" class="component" text-anchor="middle">Job Manager</text>
  <text x="255" y="428" class="small-text" text-anchor="middle">Job Control</text>
  
  <rect x="70" y="460" width="110" height="55" class="box" rx="3"/>
  <text x="125" y="480" class="component" text-anchor="middle">Service Manager</text>
  <text x="125" y="498" class="small-text" text-anchor="middle">Service Lifecycle</text>
  
  <rect x="200" y="460" width="110" height="55" class="box" rx="3"/>
  <text x="255" y="480" class="component" text-anchor="middle">Runtime</text>
  <text x="255" y="498" class="small-text" text-anchor="middle">Execution Engine</text>

  <!-- Libraries Layer -->
  <rect x="370" y="70" width="460" height="460" class="box-purple" rx="5"/>
  <text x="600" y="95" class="section-title text-white" text-anchor="middle">Libraries Layer</text>
  
  <!-- RAG Components -->
  <rect x="390" y="110" width="200" height="140" class="box" rx="3"/>
  <text x="490" y="130" class="component" text-anchor="middle" font-weight="bold">RAG Pipeline</text>
  <text x="490" y="155" class="small-text" text-anchor="middle">• Retriever (Dense/Sparse/Hybrid)</text>
  <text x="490" y="175" class="small-text" text-anchor="middle">• Generator (OpenAI/vLLM/HF)</text>
  <text x="490" y="195" class="small-text" text-anchor="middle">• Reranker (BGE/Cohere)</text>
  <text x="490" y="215" class="small-text" text-anchor="middle">• Refiner (Adaptive)</text>
  <text x="490" y="235" class="small-text" text-anchor="middle">• Evaluator</text>
  
  <!-- Agent Components -->
  <rect x="610" y="110" width="200" height="140" class="box" rx="3"/>
  <text x="710" y="130" class="component" text-anchor="middle" font-weight="bold">Agent Framework</text>
  <text x="710" y="155" class="small-text" text-anchor="middle">• Multi-Agent System</text>
  <text x="710" y="175" class="small-text" text-anchor="middle">• Tool Integration</text>
  <text x="710" y="195" class="small-text" text-anchor="middle">• Workflow Orchestration</text>
  <text x="710" y="215" class="small-text" text-anchor="middle">• Agent Communication</text>
  
  <!-- Memory & Storage -->
  <rect x="390" y="270" width="200" height="120" class="box" rx="3"/>
  <text x="490" y="290" class="component" text-anchor="middle" font-weight="bold">Memory & Storage</text>
  <text x="490" y="315" class="small-text" text-anchor="middle">• Memory Service</text>
  <text x="490" y="335" class="small-text" text-anchor="middle">• Vector Databases</text>
  <text x="490" y="355" class="small-text" text-anchor="middle">• Graph Databases</text>
  <text x="490" y="375" class="small-text" text-anchor="middle">• Embeddings</text>
  
  <!-- Middleware -->
  <rect x="610" y="270" width="200" height="120" class="box" rx="3"/>
  <text x="710" y="290" class="component" text-anchor="middle" font-weight="bold">Middleware</text>
  <text x="710" y="315" class="small-text" text-anchor="middle">• Inference APIs</text>
  <text x="710" y="335" class="small-text" text-anchor="middle">• Model Management</text>
  <text x="710" y="355" class="small-text" text-anchor="middle">• Request Routing</text>
  <text x="710" y="375" class="small-text" text-anchor="middle">• Caching</text>
  
  <!-- Data Processing -->
  <rect x="390" y="410" width="200" height="100" class="box" rx="3"/>
  <text x="490" y="430" class="component" text-anchor="middle" font-weight="bold">Data Processing</text>
  <text x="490" y="455" class="small-text" text-anchor="middle">• Document Loaders</text>
  <text x="490" y="475" class="small-text" text-anchor="middle">• Text Splitters</text>
  <text x="490" y="495" class="small-text" text-anchor="middle">• Preprocessors</text>
  
  <!-- Tools -->
  <rect x="610" y="410" width="200" height="100" class="box" rx="3"/>
  <text x="710" y="430" class="component" text-anchor="middle" font-weight="bold">Tools</text>
  <text x="710" y="455" class="small-text" text-anchor="middle">• Web Search</text>
  <text x="710" y="475" class="small-text" text-anchor="middle">• Code Execution</text>
  <text x="710" y="495" class="small-text" text-anchor="middle">• Custom Tools</text>

  <!-- Infrastructure Layer -->
  <rect x="50" y="560" width="780" height="200" class="box-red" rx="5"/>
  <text x="440" y="585" class="section-title text-white" text-anchor="middle">Infrastructure Layer</text>
  
  <rect x="70" y="600" width="170" height="140" class="box" rx="3"/>
  <text x="155" y="620" class="component" text-anchor="middle" font-weight="bold">Compute Backend</text>
  <text x="155" y="645" class="small-text" text-anchor="middle">• Ray (Distributed)</text>
  <text x="155" y="665" class="small-text" text-anchor="middle">• Local Threads</text>
  <text x="155" y="685" class="small-text" text-anchor="middle">• Process Pool</text>
  <text x="155" y="705" class="small-text" text-anchor="middle">• GPU Support</text>
  <text x="155" y="725" class="small-text" text-anchor="middle">• Resource Management</text>
  
  <rect x="260" y="600" width="170" height="140" class="box" rx="3"/>
  <text x="345" y="620" class="component" text-anchor="middle" font-weight="bold">Data Storage</text>
  <text x="345" y="645" class="small-text" text-anchor="middle">• Milvus</text>
  <text x="345" y="665" class="small-text" text-anchor="middle">• Chroma</text>
  <text x="345" y="685" class="small-text" text-anchor="middle">• Neo4j</text>
  <text x="345" y="705" class="small-text" text-anchor="middle">• PostgreSQL</text>
  <text x="345" y="725" class="small-text" text-anchor="middle">• Redis</text>
  
  <rect x="450" y="600" width="170" height="140" class="box" rx="3"/>
  <text x="535" y="620" class="component" text-anchor="middle" font-weight="bold">Model Services</text>
  <text x="535" y="645" class="small-text" text-anchor="middle">• OpenAI API</text>
  <text x="535" y="665" class="small-text" text-anchor="middle">• vLLM</text>
  <text x="535" y="685" class="small-text" text-anchor="middle">• HuggingFace</text>
  <text x="535" y="705" class="small-text" text-anchor="middle">• DashScope</text>
  <text x="535" y="725" class="small-text" text-anchor="middle">• Local Models</text>
  
  <rect x="640" y="600" width="170" height="140" class="box" rx="3"/>
  <text x="725" y="620" class="component" text-anchor="middle" font-weight="bold">Monitoring</text>
  <text x="725" y="645" class="small-text" text-anchor="middle">• Logging</text>
  <text x="725" y="665" class="small-text" text-anchor="middle">• Metrics</text>
  <text x="725" y="685" class="small-text" text-anchor="middle">• Tracing</text>
  <text x="725" y="705" class="small-text" text-anchor="middle">• Debugging</text>
  <text x="725" y="725" class="small-text" text-anchor="middle">• Performance</text>

  <!-- External Services -->
  <rect x="870" y="200" width="280" height="360" class="box" rx="5"/>
  <text x="1010" y="225" class="section-title" text-anchor="middle">External Services</text>
  
  <rect x="890" y="250" width="240" height="50" class="box" rx="3"/>
  <text x="1010" y="270" class="component" text-anchor="middle">LLM Providers</text>
  <text x="1010" y="288" class="small-text" text-anchor="middle">OpenAI, Anthropic, etc.</text>
  
  <rect x="890" y="320" width="240" height="50" class="box" rx="3"/>
  <text x="1010" y="340" class="component" text-anchor="middle">Embedding Services</text>
  <text x="1010" y="358" class="small-text" text-anchor="middle">BGE, OpenAI, Cohere</text>
  
  <rect x="890" y="390" width="240" height="50" class="box" rx="3"/>
  <text x="1010" y="410" class="component" text-anchor="middle">Vector Databases</text>
  <text x="1010" y="428" class="small-text" text-anchor="middle">Milvus, Pinecone, Weaviate</text>
  
  <rect x="890" y="460" width="240" height="50" class="box" rx="3"/>
  <text x="1010" y="480" class="component" text-anchor="middle">Data Sources</text>
  <text x="1010" y="498" class="small-text" text-anchor="middle">APIs, Databases, Files</text>

  <!-- Arrows showing data flow -->
  <!-- User to API -->
  <path d="M 190 170 L 190 200" class="arrow"/>
  
  <!-- API to Core -->
  <path d="M 190 320 L 190 350" class="arrow"/>
  
  <!-- Core to Libraries -->
  <path d="M 330 440 L 370 440" class="arrow"/>
  
  <!-- Core to Infrastructure -->
  <path d="M 190 530 L 190 560" class="arrow"/>
  
  <!-- Libraries to Infrastructure -->
  <path d="M 600 530 L 600 560" class="arrow"/>
  
  <!-- Libraries to External -->
  <path d="M 830 300 L 870 300" class="arrow-dashed"/>
  <path d="M 830 370 L 870 370" class="arrow-dashed"/>
  <path d="M 830 440 L 870 440" class="arrow-dashed"/>
  
  <!-- Infrastructure to External -->
  <path d="M 620 680 L 870 480" class="arrow-dashed"/>

  <!-- Legend -->
  <rect x="870" y="600" width="280" height="160" class="box" rx="5"/>
  <text x="1010" y="625" class="section-title" text-anchor="middle">Legend</text>
  
  <line x1="890" y1="645" x2="930" y2="645" class="arrow"/>
  <text x="940" y="650" class="small-text">Direct dependency</text>
  
  <line x1="890" y1="670" x2="930" y2="670" class="arrow-dashed"/>
  <text x="940" y="675" class="small-text">External/Optional dependency</text>
  
  <rect x="890" y="690" width="30" height="20" class="box-blue" rx="2"/>
  <text x="930" y="705" class="small-text">User Interface</text>
  
  <rect x="890" y="720" width="30" height="20" class="box-green" rx="2"/>
  <text x="930" y="735" class="small-text">Core Framework</text>
  
  <rect x="1010" y="690" width="30" height="20" class="box-orange" rx="2"/>
  <text x="1050" y="705" class="small-text">Execution</text>
  
  <rect x="1010" y="720" width="30" height="20" class="box-purple" rx="2"/>
  <text x="1050" y="735" class="small-text">Components</text>
</svg>
