# Studio å¾®è°ƒæ¨¡å‹é›†æˆ - ä¸æ»‘ä½¿ç”¨æŒ‡å—

## ğŸ“– æ¦‚è¿°

SAGE Studio ç°åœ¨å®Œç¾é›†æˆäº†å¾®è°ƒæ¨¡å‹åŠŸèƒ½ï¼Œè®©ç”¨æˆ·å¯ä»¥æ— ç¼åœ°ä½¿ç”¨è‡ªå·±å¾®è°ƒçš„æ¨¡å‹è¿›è¡Œå¯¹è¯ã€‚**æ”¯æŒ CLI å‘½ä»¤å’Œ Web UI ä¸¤ç§æ–¹å¼**ï¼Œæ•´ä¸ªæµç¨‹ä»å¾®è°ƒåˆ°ä½¿ç”¨åªéœ€å‡ æ­¥æ“ä½œï¼Œéå¸¸ä¸æ»‘ï¼

## ğŸ¯ æ ¸å¿ƒç‰¹æ€§

### 1. **è‡ªåŠ¨å‘ç°å¾®è°ƒæ¨¡å‹**
- Studio å¯åŠ¨æ—¶è‡ªåŠ¨æ‰«æ `~/.sage/studio_finetune/` ä¸‹çš„æ‰€æœ‰å®Œæˆçš„å¾®è°ƒä»»åŠ¡
- æ”¯æŒ merged æ¨¡å‹ï¼ˆåˆå¹¶åçš„å®Œæ•´æ¨¡å‹ï¼‰å’Œ LoRA æ¨¡å‹

### 2. **ä¸€é”®å¯åŠ¨å¾®è°ƒæ¨¡å‹**
- CLI: ä½¿ç”¨ `--use-finetuned` è‡ªåŠ¨é€‰æ‹©æœ€æ–°çš„å¾®è°ƒæ¨¡å‹
- Web UI: åœ¨ä¸‹æ‹‰æ¡†ä¸­ç›´æ¥é€‰æ‹©å¾®è°ƒæ¨¡å‹

### 3. **çƒ­åˆ‡æ¢æ¨¡å‹** âœ¨ æ–°åŠŸèƒ½
- **æ— éœ€é‡å¯ Studio** - åœ¨ Web UI ä¸­åˆ‡æ¢æ¨¡å‹ä¼šè‡ªåŠ¨é‡å¯ LLM æœåŠ¡
- åˆ‡æ¢åç«‹å³ç”Ÿæ•ˆï¼Œå¯ç›´æ¥ä½¿ç”¨æ–°æ¨¡å‹å¯¹è¯
- æ”¯æŒåœ¨åŸºç¡€æ¨¡å‹å’Œå¾®è°ƒæ¨¡å‹ä¹‹é—´éšæ„åˆ‡æ¢

### 4. **ç»Ÿä¸€æ¨¡å‹ç®¡ç†**
- å¾®è°ƒæ¨¡å‹é€šè¿‡ sageLLM åŠ è½½ï¼Œä½¿ç”¨ç›¸åŒçš„ VLLMService
- ä¸ HuggingFace æ¨¡å‹äº«å—ç›¸åŒçš„ç®¡ç†å’Œç¼“å­˜æœºåˆ¶

## ğŸ–¥ï¸ Web UI æ“ä½œæŒ‡å—ï¼ˆæ¨èï¼‰

### æ–¹å¼ 1ï¼šåœ¨å¾®è°ƒé¢æ¿ä¸­æ“ä½œï¼ˆå®Œæ•´æµç¨‹ï¼‰

#### æ­¥éª¤ 1: å¯åŠ¨ Studio

```bash
sage studio start
```

æµè§ˆå™¨ä¼šè‡ªåŠ¨æ‰“å¼€ `http://localhost:5173`

#### æ­¥éª¤ 2: åˆ›å»ºå¾®è°ƒä»»åŠ¡

1. ç‚¹å‡»é¡¶éƒ¨ **"Finetune"** æ ‡ç­¾
2. åœ¨ **"åˆ›å»ºå¾®è°ƒä»»åŠ¡"** å¡ç‰‡ä¸­ï¼š
   - é€‰æ‹©åŸºç¡€æ¨¡å‹ï¼ˆæ¨è `Qwen/Qwen2.5-Coder-1.5B-Instruct`ï¼‰
   - ä¸Šä¼ æ•°æ®é›†ï¼ˆJSON/JSONL æ ¼å¼ï¼‰
   - é…ç½®è®­ç»ƒå‚æ•°ï¼ˆé»˜è®¤å€¼é€‚åˆ RTX 3060ï¼‰
   - ç‚¹å‡» **"åˆ›å»ºä»»åŠ¡"** æŒ‰é’®

3. ä»»åŠ¡åˆ›å»ºåä¼šè‡ªåŠ¨å¼€å§‹è®­ç»ƒ
   - å¯ä»¥å®æ—¶æŸ¥çœ‹è®­ç»ƒè¿›åº¦
   - æŸ¥çœ‹å½“å‰ epochã€loss ç­‰æŒ‡æ ‡
   - æŸ¥çœ‹å®æ—¶æ—¥å¿—

#### æ­¥éª¤ 3: ç­‰å¾…è®­ç»ƒå®Œæˆ

è®­ç»ƒå®Œæˆåï¼Œä»»åŠ¡çŠ¶æ€ä¼šå˜ä¸º **"completed"** âœ…

#### æ­¥éª¤ 4: åˆ‡æ¢åˆ°å¾®è°ƒæ¨¡å‹ï¼ˆçƒ­åˆ‡æ¢ ğŸ”¥ï¼‰

**æ–¹æ³• A: ä»å½“å‰æ¨¡å‹ä¸‹æ‹‰æ¡†åˆ‡æ¢**

1. åœ¨é¡µé¢é¡¶éƒ¨æ‰¾åˆ° **"å½“å‰ä½¿ç”¨çš„æ¨¡å‹"** å¡ç‰‡
2. ç‚¹å‡»ä¸‹æ‹‰æ¡†ï¼Œä¼šçœ‹åˆ°ï¼š
   ```
   â”œâ”€â”€ åŸºç¡€æ¨¡å‹
   â”‚   â”œâ”€â”€ Qwen/Qwen2.5-7B-Instruct    [åŸºç¡€]
   â”‚   â””â”€â”€ Qwen/Qwen2.5-0.5B-Instruct  [åŸºç¡€]
   â””â”€â”€ å¾®è°ƒæ¨¡å‹
       â”œâ”€â”€ ~/.sage/studio_finetune/task_xxx/merged_model  [å¾®è°ƒ]
       â””â”€â”€ ~/.sage/studio_finetune/task_yyy/lora          [å¾®è°ƒ]
   ```
3. é€‰æ‹©ä½ æƒ³è¦çš„å¾®è°ƒæ¨¡å‹
4. ç³»ç»Ÿä¼šæ˜¾ç¤ºï¼š
   - âœ… **"æ¨¡å‹å·²åˆ‡æ¢å¹¶ç”Ÿæ•ˆ"** - LLM æœåŠ¡è‡ªåŠ¨é‡å¯ï¼Œç«‹å³å¯ç”¨
   - âš ï¸ **"æ¨¡å‹å·²åˆ‡æ¢"** - å¦‚æœ LLM æœåŠ¡æœªè¿è¡Œï¼Œä¸‹æ¬¡å¯åŠ¨æ—¶ç”Ÿæ•ˆ

**æ–¹æ³• B: ä»ä»»åŠ¡åˆ—è¡¨å¿«é€Ÿåˆ‡æ¢**

1. åœ¨ **"å¾®è°ƒä»»åŠ¡"** è¡¨æ ¼ä¸­æ‰¾åˆ°å·²å®Œæˆçš„ä»»åŠ¡
2. ç‚¹å‡»è¯¥ä»»åŠ¡è¡Œçš„ **"åˆ‡æ¢ä¸ºå¯¹è¯åç«¯"** æŒ‰é’®
3. æ¨¡å‹è‡ªåŠ¨åˆ‡æ¢å¹¶é‡å¯ LLM æœåŠ¡

#### æ­¥éª¤ 5: å¼€å§‹å¯¹è¯ ğŸ’¬

1. ç‚¹å‡»é¡¶éƒ¨ **"Chat"** æ ‡ç­¾
2. åœ¨èŠå¤©ç•Œé¢è¾“å…¥æ¶ˆæ¯
3. ä½ çš„å¾®è°ƒæ¨¡å‹ä¼šè‡ªåŠ¨å¤„ç†å¯¹è¯ï¼

### æ–¹å¼ 2: æŸ¥çœ‹å’Œç®¡ç†æ¨¡å‹

#### æŸ¥çœ‹æ‰€æœ‰å¯ç”¨æ¨¡å‹

åœ¨ **"Finetune"** é¢æ¿çš„ **"å½“å‰ä½¿ç”¨çš„æ¨¡å‹"** ä¸‹æ‹‰æ¡†ä¸­ï¼Œå¯ä»¥çœ‹åˆ°ï¼š
- æ‰€æœ‰åŸºç¡€æ¨¡å‹ï¼ˆè“è‰²æ ‡ç­¾ [åŸºç¡€]ï¼‰
- æ‰€æœ‰å¾®è°ƒå®Œæˆçš„æ¨¡å‹ï¼ˆç»¿è‰²æ ‡ç­¾ [å¾®è°ƒ]ï¼‰

#### æŸ¥çœ‹å¾®è°ƒä»»åŠ¡è¯¦æƒ…

åœ¨ **"å¾®è°ƒä»»åŠ¡"** è¡¨æ ¼ä¸­ï¼Œç‚¹å‡»ä»»åŠ¡å¯ä»¥æŸ¥çœ‹ï¼š
- è®­ç»ƒé…ç½®
- è®­ç»ƒè¿›åº¦å’ŒæŒ‡æ ‡
- å®æ—¶æ—¥å¿—è¾“å‡º
- è¾“å‡ºç›®å½•è·¯å¾„

## ğŸš€ CLI æ“ä½œæŒ‡å—ï¼ˆé«˜çº§ç”¨æˆ·ï¼‰

### å¿«é€Ÿå¼€å§‹

### æ­¥éª¤ 1: å¾®è°ƒä¸€ä¸ªæ¨¡å‹

```bash
# ä½¿ç”¨ Studio å¾®è°ƒå‘å¯¼
sage finetune start

# æˆ–ç›´æ¥é€šè¿‡ Studio Web UI è¿›è¡Œå¾®è°ƒ
sage studio start
# ç„¶ååœ¨ Web UI ä¸­è¿›è¡Œå¾®è°ƒæ“ä½œ
```

### æ­¥éª¤ 2: æŸ¥çœ‹å¯ç”¨çš„å¾®è°ƒæ¨¡å‹

```bash
# åˆ—å‡ºæ‰€æœ‰å¯ç”¨çš„å¾®è°ƒæ¨¡å‹
sage studio start --list-finetuned
```

è¾“å‡ºç¤ºä¾‹ï¼š
```
ğŸ“ å¯ç”¨çš„å¾®è°ƒæ¨¡å‹ (2):

1. code_expert_2024
   ç±»å‹: merged
   åŸºç¡€æ¨¡å‹: Qwen/Qwen2.5-Coder-7B-Instruct
   è·¯å¾„: /home/user/.sage/studio_finetune/code_expert_2024/merged_model
   å®Œæˆæ—¶é—´: 2024-11-23T10:30:00

2. chat_assistant_2024
   ç±»å‹: lora
   åŸºç¡€æ¨¡å‹: Qwen/Qwen2.5-7B-Instruct
   è·¯å¾„: /home/user/.sage/studio_finetune/chat_assistant_2024/lora
   å®Œæˆæ—¶é—´: 2024-11-23T09:15:00

ğŸ’¡ ä½¿ç”¨æ–¹å¼ï¼š
  sage studio start --use-finetuned     # ä½¿ç”¨æœ€æ–°å¾®è°ƒæ¨¡å‹
  sage studio start --llm-model "/home/user/.sage/studio_finetune/code_expert_2024/merged_model"  # æŒ‡å®šç‰¹å®šæ¨¡å‹
```

### æ­¥éª¤ 3: å¯åŠ¨ Studio å¹¶ä½¿ç”¨å¾®è°ƒæ¨¡å‹

```bash
# æ–¹å¼ 1: ä½¿ç”¨æœ€æ–°çš„å¾®è°ƒæ¨¡å‹ï¼ˆæ¨èï¼‰
sage studio start --use-finetuned

# æ–¹å¼ 2: æŒ‡å®šç‰¹å®šçš„å¾®è°ƒæ¨¡å‹
sage studio start --llm-model "/path/to/your/finetuned/model"

# æ–¹å¼ 3: æŒ‡å®šæ¨¡å‹åç§°ï¼ˆä»»åŠ¡ IDï¼‰
sage studio start --llm-model "code_expert_2024"
```

## ï¿½ UI æˆªå›¾è¯´æ˜

### å¾®è°ƒé¢æ¿å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ”§ æ¨¡å‹å¾®è°ƒ                                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“Œ å½“å‰ä½¿ç”¨çš„æ¨¡å‹                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Qwen/Qwen2.5-0.5B-Instruct        [ä¸‹æ‹‰æ¡†é€‰æ‹©æ¨¡å‹ â–¼] â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â• åˆ›å»ºå¾®è°ƒä»»åŠ¡                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ åŸºç¡€æ¨¡å‹: [Qwen/Qwen2.5-Coder-1.5B-Instruct â–¼]       â”‚  â”‚
â”‚  â”‚ æ•°æ®é›†:   [ä¸Šä¼  JSON/JSONL æ–‡ä»¶]                      â”‚  â”‚
â”‚  â”‚ Epochs:   [3]        Batch Size: [1]                 â”‚  â”‚
â”‚  â”‚ Learning Rate: [0.00005]                             â”‚  â”‚
â”‚  â”‚ [åˆ›å»ºä»»åŠ¡] æŒ‰é’®                                        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ï¿½ğŸ“‹ å¾®è°ƒä»»åŠ¡åˆ—è¡¨                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ID â”‚ æ¨¡å‹ â”‚ çŠ¶æ€   â”‚ è¿›åº¦   â”‚ Loss   â”‚ æ“ä½œ         â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ 001â”‚ Qwen â”‚ âœ…å®Œæˆ â”‚ 100%   â”‚ 0.234  â”‚ [åˆ‡æ¢ä¸ºå¯¹è¯] â”‚  â”‚
â”‚  â”‚ 002â”‚ Qwen â”‚ ğŸ”„è®­ç»ƒ â”‚ 67%    â”‚ 0.456  â”‚ [æŸ¥çœ‹æ—¥å¿—]   â”‚  â”‚
â”‚  â”‚ 003â”‚ Qwen â”‚ â³æ’é˜Ÿ â”‚ 0%     â”‚ -      â”‚ [å–æ¶ˆ]       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### èŠå¤©ç•Œé¢ï¼ˆä½¿ç”¨å¾®è°ƒæ¨¡å‹ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ’¬ Chat  [å½“å‰æ¨¡å‹: å¾®è°ƒæ¨¡å‹ task_001]                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ‘¤ User: è§£é‡Šä¸€ä¸‹è¿™æ®µä»£ç çš„åŠŸèƒ½                              â”‚
â”‚                                                               â”‚
â”‚  ğŸ¤– Assistant: [ä½¿ç”¨ä½ çš„å¾®è°ƒæ¨¡å‹å›ç­”]                         â”‚
â”‚     è¿™æ®µä»£ç å®ç°äº†...ï¼ˆä¸“ä¸šä¸”ç²¾å‡†çš„å›ç­”ï¼‰                      â”‚
â”‚                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ è¾“å…¥æ¶ˆæ¯...                                    [å‘é€] â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ¨ Web UI vs CLI å¯¹æ¯”

| åŠŸèƒ½ | Web UI | CLI | æ¨èåœºæ™¯ |
|------|--------|-----|----------|
| **åˆ›å»ºå¾®è°ƒä»»åŠ¡** | âœ… å¯è§†åŒ–è¡¨å• | âœ… å‘½ä»¤è¡Œ | Web UIï¼ˆæ›´ç›´è§‚ï¼‰ |
| **ç›‘æ§è®­ç»ƒè¿›åº¦** | âœ… å®æ—¶å›¾è¡¨ | âŒ éœ€æŸ¥çœ‹æ—¥å¿— | Web UIï¼ˆå®æ—¶æ›´æ–°ï¼‰ |
| **åˆ‡æ¢æ¨¡å‹** | âœ… ä¸‹æ‹‰é€‰æ‹© + çƒ­åˆ‡æ¢ | âœ… å‘½ä»¤å‚æ•° | Web UIï¼ˆå³æ—¶ç”Ÿæ•ˆï¼‰ |
| **æŸ¥çœ‹æ—¥å¿—** | âœ… å†…ç½®æŸ¥çœ‹å™¨ | âœ… æ–‡ä»¶æŸ¥çœ‹ | Web UIï¼ˆè¿‡æ»¤å’Œæœç´¢ï¼‰ |
| **æ‰¹é‡æ“ä½œ** | âŒ | âœ… è„šæœ¬è‡ªåŠ¨åŒ– | CLIï¼ˆæ‰¹å¤„ç†ï¼‰ |
| **è¿œç¨‹è®¿é—®** | âœ… æµè§ˆå™¨è®¿é—® | âœ… SSH | Web UIï¼ˆæ›´æ–¹ä¾¿ï¼‰ |

**å»ºè®®**ï¼š
- ğŸ¨ **æ—¥å¸¸ä½¿ç”¨**ï¼šWeb UIï¼ˆå¯è§†åŒ–ã€å®æ—¶åé¦ˆã€çƒ­åˆ‡æ¢ï¼‰
- ğŸ”§ **è‡ªåŠ¨åŒ–/è„šæœ¬**ï¼šCLIï¼ˆæ‰¹é‡å¤„ç†ã€CI/CD é›†æˆï¼‰
- ğŸš€ **å¿«é€Ÿæµ‹è¯•**ï¼šCLIï¼ˆä¸€è¡Œå‘½ä»¤å¯åŠ¨ï¼‰

## ğŸ“ å®Œæ•´å·¥ä½œæµç¨‹å¯¹æ¯”

### Web UI å·¥ä½œæµï¼ˆæ¨èæ–°æ‰‹ï¼‰

### Web UI å·¥ä½œæµï¼ˆæ¨èæ–°æ‰‹ï¼‰

```mermaid
graph LR
    A[å¯åŠ¨ Studio] --> B[æ‰“å¼€ Finetune é¢æ¿]
    B --> C[ä¸Šä¼ æ•°æ®é›†]
    C --> D[é…ç½®å‚æ•°]
    D --> E[åˆ›å»ºä»»åŠ¡]
    E --> F[å®æ—¶ç›‘æ§è¿›åº¦]
    F --> G{è®­ç»ƒå®Œæˆ?}
    G -->|æ˜¯| H[ç‚¹å‡»ä¸‹æ‹‰æ¡†]
    H --> I[é€‰æ‹©å¾®è°ƒæ¨¡å‹]
    I --> J[è‡ªåŠ¨çƒ­åˆ‡æ¢ ğŸ”¥]
    J --> K[åˆ‡æ¢åˆ° Chat æ ‡ç­¾]
    K --> L[å¼€å§‹å¯¹è¯ ğŸ’¬]
    G -->|å¦| F
```

**ç‰¹ç‚¹**ï¼š
- âœ… å…¨ç¨‹å¯è§†åŒ–æ“ä½œ
- âœ… å®æ—¶è¿›åº¦åé¦ˆ
- âœ… ä¸€é”®çƒ­åˆ‡æ¢ï¼Œæ— éœ€é‡å¯
- âœ… é€‚åˆæ–°æ‰‹å’Œæ—¥å¸¸ä½¿ç”¨

### CLI å·¥ä½œæµï¼ˆæ¨èé«˜çº§ç”¨æˆ·ï¼‰

```mermaid
graph LR
    A[sage finetune start] --> B[ç­‰å¾…å®Œæˆ]
    B --> C[sage studio start --list-finetuned]
    C --> D[sage studio start --use-finetuned]
    D --> E[æ‰“å¼€æµè§ˆå™¨]
    E --> F[å¼€å§‹å¯¹è¯]
```

**ç‰¹ç‚¹**ï¼š
- âœ… å‘½ä»¤è¡Œæ“ä½œ
- âœ… é€‚åˆè„šæœ¬å’Œè‡ªåŠ¨åŒ–
- âœ… ä¸€è¡Œå‘½ä»¤å¯åŠ¨
- âœ… é€‚åˆè¿œç¨‹æœåŠ¡å™¨

## ğŸ”§ é«˜çº§åŠŸèƒ½

### 1. æ¨¡å‹çƒ­åˆ‡æ¢åŸç†

å½“ä½ åœ¨ Web UI ä¸­åˆ‡æ¢æ¨¡å‹æ—¶ï¼Œåç«¯ä¼šï¼š

```python
# 1. æ›´æ–°ç¯å¢ƒå˜é‡
os.environ["SAGE_CHAT_MODEL"] = new_model_path

# 2. åœæ­¢å½“å‰ LLM æœåŠ¡
chat_manager._stop_llm_service()

# 3. å¯åŠ¨æ–° LLM æœåŠ¡
chat_manager._start_llm_service(model=new_model_path)

# 4. Gateway è‡ªåŠ¨æ£€æµ‹æ–°æœåŠ¡ï¼ˆIntelligentLLMClientï¼‰
# æ— éœ€æ‰‹åŠ¨é…ç½®ï¼
```

**ä¼˜åŠ¿**ï¼š
- ğŸš€ **ç§’çº§åˆ‡æ¢** - æ— éœ€é‡å¯æ•´ä¸ª Studio
- ğŸ”„ **è‡ªåŠ¨æ£€æµ‹** - Gateway è‡ªåŠ¨ä½¿ç”¨æ–°æ¨¡å‹
- ğŸ’¾ **çŠ¶æ€ä¿æŒ** - èŠå¤©å†å²ä¸ä¸¢å¤±

### 2. åœ¨å·²è¿è¡Œçš„ Studio ä¸­åˆ‡æ¢æ¨¡å‹

å¦‚æœ Studio å·²ç»åœ¨è¿è¡Œï¼Œæœ‰ä¸‰ç§æ–¹å¼åˆ‡æ¢ï¼š

**æ–¹å¼ A: Web UI ä¸‹æ‹‰æ¡†ï¼ˆæ¨èï¼‰**
1. æ‰“å¼€ Finetune é¢æ¿
2. ä»ä¸‹æ‹‰æ¡†é€‰æ‹©æ–°æ¨¡å‹
3. è‡ªåŠ¨çƒ­åˆ‡æ¢ âœ…

**æ–¹å¼ B: API è°ƒç”¨**
```bash
curl -X POST "http://localhost:5173/api/finetune/switch-model?model_path=/path/to/model"
```

**æ–¹å¼ C: é‡å¯ Studio**
```bash
sage studio restart --use-finetuned
```

### 3. å¤šæ¨¡å‹ç®¡ç†

**åœºæ™¯**ï¼šä½ æœ‰å¤šä¸ªå¾®è°ƒæ¨¡å‹ï¼Œéœ€è¦é¢‘ç¹åˆ‡æ¢

```bash
# æ¨¡å‹ A: ä»£ç ä¸“å®¶
~/.sage/studio_finetune/code_expert/merged_model

# æ¨¡å‹ B: æ–‡æ¡£å†™æ‰‹
~/.sage/studio_finetune/doc_writer/merged_model

# æ¨¡å‹ C: å¯¹è¯åŠ©æ‰‹
~/.sage/studio_finetune/chat_assistant/merged_model
```

**åœ¨ Web UI ä¸­**ï¼š
1. ä¸‹æ‹‰æ¡†ä¼šåˆ—å‡ºæ‰€æœ‰æ¨¡å‹
2. æ ‡ç­¾æ˜¾ç¤ºæ¨¡å‹ç±»å‹ [åŸºç¡€]/[å¾®è°ƒ]
3. é¼ æ ‡æ‚¬åœæ˜¾ç¤ºå®Œæ•´è·¯å¾„
4. ç‚¹å‡»åˆ‡æ¢ï¼Œç«‹å³ç”Ÿæ•ˆ

### 4. ä¸ Gateway çš„é›†æˆ

Studio ä½¿ç”¨ `IntelligentLLMClient` è‡ªåŠ¨æ£€æµ‹ LLM æœåŠ¡ï¼š

```python
# æ£€æµ‹é¡ºåº
1. æ£€æŸ¥ localhost:8001 (æœ¬åœ° LLM æœåŠ¡)
2. æ£€æŸ¥ localhost:8000 (å¤‡ç”¨ç«¯å£)
3. å›é€€åˆ°äº‘ç«¯ API (DashScope/OpenAI)
```

**è¿™æ„å‘³ç€**ï¼š
- âœ… åˆ‡æ¢æ¨¡å‹åï¼ŒGateway è‡ªåŠ¨ä½¿ç”¨æ–°æœåŠ¡
- âœ… æ— éœ€æ‰‹åŠ¨é…ç½® API ç«¯ç‚¹
- âœ… æœ¬åœ°æ¨¡å‹ä¼˜å…ˆï¼Œäº‘ç«¯å…œåº•

## ğŸ“‹ å®Œæ•´å·¥ä½œæµç¨‹ç¤ºä¾‹

### åœºæ™¯ 1: ä»£ç ç†è§£å¾®è°ƒ â†’ å¯¹è¯ä½¿ç”¨ï¼ˆWeb UIï¼‰

```bash
# 1. å¾®è°ƒä¸€ä¸ªä»£ç ç†è§£æ¨¡å‹
sage finetune start --task code --model Qwen/Qwen2.5-Coder-7B-Instruct

# 2. ç­‰å¾…å¾®è°ƒå®Œæˆ...ï¼ˆä¼šæ˜¾ç¤ºè¿›åº¦ï¼‰

# 3. æŸ¥çœ‹å¯ç”¨æ¨¡å‹
sage studio start --list-finetuned

# 4. ä½¿ç”¨å¾®è°ƒæ¨¡å‹å¯åŠ¨ Studio
sage studio start --use-finetuned

# 5. åœ¨ Chat ç•Œé¢ä¸­ä¸ä½ çš„ä»£ç ä¸“å®¶æ¨¡å‹å¯¹è¯ï¼
```

### åœºæ™¯ 2: è‡ªå®šä¹‰æ•°æ®é›†å¾®è°ƒ â†’ ä¸“ä¸šåŠ©æ‰‹

```bash
# 1. å‡†å¤‡ä½ çš„æ•°æ®é›†ï¼ˆJSON æ ¼å¼ï¼‰
cat > my_data.json << EOF
[
  {
    "instruction": "ä½ çš„æŒ‡ä»¤",
    "input": "è¾“å…¥å†…å®¹",
    "output": "æœŸæœ›è¾“å‡º"
  }
]
EOF

# 2. å¯åŠ¨å¾®è°ƒ
sage finetune start --task custom --data my_data.json

# 3. å¾®è°ƒå®Œæˆåï¼Œä½¿ç”¨æ¨¡å‹
sage studio restart --use-finetuned
```

## ğŸ”§ é«˜çº§ç”¨æ³•

### 1. åœ¨å·²è¿è¡Œçš„ Studio ä¸­åˆ‡æ¢æ¨¡å‹

```bash
# Studio å·²ç»åœ¨è¿è¡Œï¼Œæƒ³åˆ‡æ¢åˆ°å¾®è°ƒæ¨¡å‹

# æ–¹å¼ 1: é€šè¿‡ APIï¼ˆä¸é‡å¯ï¼‰
curl -X POST http://localhost:5173/api/finetune/switch-model \
  -H "Content-Type: application/json" \
  -d '{"model_path": "/path/to/finetuned/model"}'

# æ–¹å¼ 2: é‡å¯å¹¶åˆ‡æ¢
sage studio restart --use-finetuned
```

### 2. ç»„åˆä½¿ç”¨ä¸åŒå‚æ•°

```bash
# ä½¿ç”¨å¾®è°ƒæ¨¡å‹ + è‡ªå®šä¹‰ç«¯å£
sage studio start --use-finetuned --port 8080

# ä½¿ç”¨å¾®è°ƒæ¨¡å‹ + ç”Ÿäº§æ¨¡å¼
sage studio start --use-finetuned --prod

# ä½¿ç”¨å¾®è°ƒæ¨¡å‹ + æ›´å¤š GPU å†…å­˜
SAGE_STUDIO_LLM_GPU_MEMORY=0.95 sage studio start --use-finetuned
```

### 3. æŸ¥çœ‹æ¨¡å‹çŠ¶æ€

```bash
# æŸ¥çœ‹å½“å‰è¿è¡Œçš„æ¨¡å‹
sage studio status

# æŸ¥çœ‹æ‰€æœ‰å¯ç”¨æ¨¡å‹ï¼ˆåŒ…æ‹¬ HF å’Œå¾®è°ƒï¼‰
sage llm model show
sage studio start --list-finetuned
```

## ğŸ—ï¸ æ¶æ„è¯´æ˜

### æ¨¡å‹å‘ç°æµç¨‹

```
Studio å¯åŠ¨
    â†“
ChatModeManager.list_finetuned_models()
    â†“
æŸ¥è¯¢ FinetuneManager çš„å·²å®Œæˆä»»åŠ¡
    â†“
æ£€æŸ¥æ¯ä¸ªä»»åŠ¡çš„è¾“å‡ºç›®å½•
    â”œâ”€â”€ merged_model/ (ä¼˜å…ˆä½¿ç”¨)
    â””â”€â”€ lora/ (å¦‚æœæ²¡æœ‰ merged)
    â†“
è¿”å›å¯ç”¨æ¨¡å‹åˆ—è¡¨
```

### æ¨¡å‹åŠ è½½æµç¨‹

```
sage studio start --use-finetuned
    â†“
ChatModeManager._start_llm_service(use_finetuned=True)
    â†“
è·å–æœ€æ–°å¾®è°ƒæ¨¡å‹è·¯å¾„
    â†“
æ£€æµ‹æ˜¯æœ¬åœ°è·¯å¾„ â†’ ä¸è‡ªåŠ¨ä¸‹è½½
    â†“
VLLMService åŠ è½½æ¨¡å‹
    â”œâ”€â”€ HF æ¨¡å‹: é€šè¿‡ vllm_registry.ensure_model_available()
    â””â”€â”€ æœ¬åœ°æ¨¡å‹: ç›´æ¥åŠ è½½è·¯å¾„
    â†“
LLM æœåŠ¡å°±ç»ª (http://localhost:8001)
    â†“
Gateway è‡ªåŠ¨æ£€æµ‹å¹¶ä½¿ç”¨ (IntelligentLLMClient)
    â†“
Studio Chat å¯ç”¨ï¼
```

### æ¨¡å‹ç±»å‹

| ç±»å‹ | è¯´æ˜ | ä¼˜å…ˆçº§ | åŠ è½½é€Ÿåº¦ | æ¨ç†æ€§èƒ½ |
|------|------|--------|---------|---------|
| **merged** | åˆå¹¶åçš„å®Œæ•´æ¨¡å‹ | é«˜ | å¿« | æœ€å¥½ |
| **lora** | LoRA æƒé‡ | ä¸­ | è¾ƒå¿« | å¥½ |

## ğŸ“ æ–‡ä»¶ä½ç½®

```
~/.sage/
â”œâ”€â”€ studio_finetune/           # Studio å¾®è°ƒè¾“å‡º
â”‚   â”œâ”€â”€ task_id_1/
â”‚   â”‚   â”œâ”€â”€ merged_model/      # åˆå¹¶åçš„æ¨¡å‹ï¼ˆä¼˜å…ˆï¼‰
â”‚   â”‚   â”œâ”€â”€ lora/              # LoRA æƒé‡
â”‚   â”‚   â”œâ”€â”€ checkpoints/       # è®­ç»ƒæ£€æŸ¥ç‚¹
â”‚   â”‚   â””â”€â”€ finetune_meta.json # å…ƒæ•°æ®
â”‚   â””â”€â”€ task_id_2/
â”‚       â””â”€â”€ ...
â”œâ”€â”€ models/vllm/               # HuggingFace æ¨¡å‹ç¼“å­˜
â”‚   â”œâ”€â”€ Qwen__Qwen2.5-0.5B-Instruct/
â”‚   â””â”€â”€ metadata.json
â””â”€â”€ finetune_output/           # CLI finetune è¾“å‡ºï¼ˆä¸åŒä½ç½®ï¼‰
```

## ğŸ¨ Web UI é›†æˆ

Studio çš„ Web UI å·²ç»å†…ç½®äº†å¾®è°ƒæ¨¡å‹ç®¡ç†ï¼š

1. **å¾®è°ƒä»»åŠ¡åˆ›å»º**: åœ¨ Finetune é¡µé¢åˆ›å»ºå¾®è°ƒä»»åŠ¡
2. **è¿›åº¦ç›‘æ§**: å®æ—¶æŸ¥çœ‹å¾®è°ƒè¿›åº¦
3. **æ¨¡å‹åˆ‡æ¢**: åœ¨ Chat é¡µé¢åˆ‡æ¢åˆ°å¾®è°ƒæ¨¡å‹
4. **æ¨¡å‹åˆ—è¡¨**: æŸ¥çœ‹æ‰€æœ‰å¯ç”¨æ¨¡å‹ï¼ˆåŸºç¡€ + å¾®è°ƒï¼‰

## ğŸ” æ•…éšœæ’æŸ¥

### é—®é¢˜ 1: æ‰¾ä¸åˆ°å¾®è°ƒæ¨¡å‹

```bash
# æ£€æŸ¥å¾®è°ƒä»»åŠ¡çŠ¶æ€
ls -la ~/.sage/studio_finetune/

# æ£€æŸ¥ä»»åŠ¡æ˜¯å¦å®Œæˆ
sage studio start --list-finetuned

# å¦‚æœæ˜¾ç¤ºç©ºï¼Œè¯´æ˜è¿˜æ²¡æœ‰å®Œæˆçš„å¾®è°ƒä»»åŠ¡
```

### é—®é¢˜ 2: æ¨¡å‹åŠ è½½å¤±è´¥

```bash
# æ£€æŸ¥æ¨¡å‹è·¯å¾„æ˜¯å¦å­˜åœ¨
ls -la /path/to/your/finetuned/model

# æ£€æŸ¥æ˜¯å¦æœ‰ config.json ç­‰å¿…è¦æ–‡ä»¶
ls -la /path/to/your/finetuned/model/*.json

# æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
sage studio logs --gateway
```

### é—®é¢˜ 3: GPU å†…å­˜ä¸è¶³

```bash
# å‡å°‘ GPU å†…å­˜ä½¿ç”¨
SAGE_STUDIO_LLM_GPU_MEMORY=0.7 sage studio start --use-finetuned

# æˆ–ä½¿ç”¨é‡åŒ–åŠ è½½ï¼ˆéœ€è¦åœ¨å¾®è°ƒé…ç½®ä¸­è®¾ç½®ï¼‰
```

## ğŸ’¡ æœ€ä½³å®è·µ

### 1. æ¨¡å‹å‘½å

- ä½¿ç”¨æè¿°æ€§çš„ä»»åŠ¡ IDï¼š`code_expert_2024`ã€`doc_writer_v2`
- é¿å…ä½¿ç”¨ç‰¹æ®Šå­—ç¬¦å’Œç©ºæ ¼

### 2. æ¨¡å‹ç®¡ç†

- å®šæœŸæ¸…ç†æ—§çš„å¾®è°ƒæ¨¡å‹ï¼š`rm -rf ~/.sage/studio_finetune/old_task_id`
- ä¿ç•™å…ƒæ•°æ®æ–‡ä»¶ï¼š`finetune_meta.json`

### 3. èµ„æºä¼˜åŒ–

- å°æ•°æ®é›†ç”¨ 0.5B/1.5B æ¨¡å‹å¾®è°ƒ
- ç”Ÿäº§ç¯å¢ƒå»ºè®®ä½¿ç”¨ merged æ¨¡å‹ï¼ˆæ›´å¿«ï¼‰
- å¼€å‘æµ‹è¯•å¯ä»¥ç”¨ LoRA æ¨¡å‹ï¼ˆèŠ‚çœç©ºé—´ï¼‰

### 4. å·¥ä½œæµå»ºè®®

```bash
# å¼€å‘æµç¨‹
1. sage finetune start --task code --model Qwen/Qwen2.5-Coder-1.5B-Instruct
2. sage finetune merge task_id  # åˆå¹¶æ¨¡å‹
3. sage studio start --use-finetuned  # æµ‹è¯•

# ç”Ÿäº§æµç¨‹
1. ä½¿ç”¨æ›´å¤§æ¨¡å‹å¾®è°ƒ
2. ä¸¥æ ¼éªŒè¯æ¨¡å‹æ€§èƒ½
3. åˆå¹¶å¹¶éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ
```

## ğŸ¯ æ€»ç»“

é€šè¿‡è¿™ä¸ªé›†æˆæ–¹æ¡ˆï¼Œä½ å¯ä»¥ï¼š

1. âœ… **æ— ç¼å¾®è°ƒ**: åœ¨ Studio ä¸­å¾®è°ƒæ¨¡å‹
2. âœ… **è‡ªåŠ¨å‘ç°**: Studio è‡ªåŠ¨å‘ç°æ‰€æœ‰å¾®è°ƒæ¨¡å‹
3. âœ… **ä¸€é”®å¯åŠ¨**: `--use-finetuned` ä¸€é”®ä½¿ç”¨æœ€æ–°æ¨¡å‹
4. âœ… **ä¸æ»‘åˆ‡æ¢**: æ”¯æŒçƒ­åˆ‡æ¢å’Œé‡å¯åˆ‡æ¢
5. âœ… **ç»Ÿä¸€ç®¡ç†**: sageLLM ç»Ÿä¸€ç®¡ç†æ‰€æœ‰æ¨¡å‹

æ•´ä¸ªæµç¨‹ä»å¾®è°ƒåˆ°ä½¿ç”¨ï¼Œåªéœ€è¦ï¼š

```bash
sage finetune start    # å¾®è°ƒ
sage studio start --use-finetuned  # ä½¿ç”¨
```

å°±æ˜¯è¿™ä¹ˆç®€å•ï¼ğŸ‰
